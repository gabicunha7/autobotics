<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historico de alertas</title>
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/dash_historico_alertas.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/rotaDash.js"></script>
    <script src="js/sessao.js"></script>
    <script src="js/dashHistoricoAlerta.js"></script>
</head>


<body>

    <aside>

        <section>
            <section class="menu-container">
                <img class="img-logo-curta" src="assets/logo/LOGO_CURTA.png" alt="">
                <h1>MENU</h1>

                <div class="paginas-container">

                    <div class="menu-dropdown-container">

                        <button class="a-pagina" onclick="menu(event)" id="selecionado" tag="agora">
                            <img class="icon-pagina" src="assets/icones/dash_icon.png" alt="">
                            Dashboards
                            <img class="icon-pagina" src="assets/icones/arrow_down.png" alt="">
                        </button>


                        <div class="menu-dropdown-items" id="menuDropdown">
                        </div>
                    </div>


                    <a class="a-pagina" href="alerta.html">
                        <img class="icon-pagina" src="assets/icones/alerta_icon.png" alt="">
                        Alertas
                    </a>
                    <a class="a-pagina" href="parametros.html">
                        <img class="icon-pagina" src="assets/icones/parametros_icon.png" alt="">
                        Parâmetros
                    </a>

                    <a class="a-pagina" href="setor.html">
                        <img class="icon-pagina" src="assets/icones/setor_icon.png" alt="">
                        Setores
                    </a>
                    <a class="a-pagina" href="controladores.html">
                        <img class="icon-pagina" src="assets/icones/controlador_icon.png" alt="">
                        Controladores
                    </a>
                    <a class="a-pagina" href="funcionario.html">
                        <img class="icon-pagina" src="assets/icones/userImg.png" alt="">
                        Funcionários
                    </a>
                </div>
            </section>
            <a href="index.html">
                <button id="btn-sair" onclick="limparSessao()">
                    <img class="icon-sair" src="assets/icones/sair_icon.png" alt="">
                    Sair
                </button>
            </a>

    </aside>

    <section class="container-content">

        <div class="div-superior">
            <div class="div-titulo">
                <h1>Historico de alertas dos setores</h1>
            </div>

            <div class="data">

                <div id="data_atual" style="font-size: 18px; font-weight: 600; color: #222;"></div>

            </div>

            <div class="div-usuario">
                <div class="div-img-usuario"><img src="assets/icones/foto_usuario.png" alt=""></div>
                <div>
                    <h6 id="nome-usuario">Usuário</h6>
                    <p id="email-usuario">usuario@email.com</p>
                </div>
            </div>
        </div>

        <div class="div-conteudo">


            <div class="esquerda">

                <h1>Alertas por setor:</h1>

                <div class="esquerda-subtitulo">

                    <p style="font-size: medium; margin-right: 25px;">(Clique em um setor para exibir seus dados.)</p>

                    <div class="esquerda-subtitulo-texto">Neste mês</div>
                </div>

                <table class="tabela" id="tabelaSetores">
                    <tr>
                        <th>Setor</th>
                        <th>Mês atual</th>
                        <th>Totais</th>
                        <th>Média em CPU</th>
                        <th>Média em RAM</th>
                        <th>Média em Disco</th>
                    </tr>



                </table>

            </div>

            <div class="direita">





                <div class="conteudo-dados" id="conteudoDados">

                    <div class="comparacao">
                        <div class="comparacao-titulo" id="tituloComparacao">Comparação de alertas:</div>

                        <div class="comparacao-colunas">
                            <div class="comparacao-col">
                                <div class="comp-subtitulo">Mês anterior:</div>
                                <div class="comp-valor" id="mesAnterior"></div>
                            </div>

                            <div class="comparacao-col">
                                <div class="comp-subtitulo">Este mês:</div>
                                <div class="comp-valor" id="mesAtual"></div>
                            </div>

                            <div class="comparacao-col">
                                <div class="comp-subtitulo"></div>
                                <div class="comp-valor"><span class="texto-alertas"></span></div>
                                <div class="comp-percentual"></div>
                            </div>
                        </div>

                    </div>

                    <div class="kpis">

                        <div class="kpi1">
                            <div class="kpi-titulo">Mais alertas em:</div>
                            <span class="componente" id="componenteMaisAlertas"></span>
                        </div>

                        <div class="kpi2">
                            <div class="kpi-titulo">Alertas em <span id="componenteSubtitulo"></span>:</div>
                            <span class="qtd_alertasComponente"></span>
                        </div>
                    </div>


                    <div class="grafico">
                        <canvas id="grafico_alertas"></canvas>
                    </div>

                </div>

            </div>

        </div>

    </section>

        <div id="div_aguardar" class="loading-div">
            <img src="assets\logo\LOGO_CURTA.png" alt="Icone logo aguardar">
            <div class="borda_aguardar"></div>
        </div>

</body>




<script>
    const dataAtual = new Date();
    const dia = dataAtual.getDate();
    const mes = dataAtual.getMonth() + 1;
    const ano = dataAtual.getFullYear();

    document.getElementById("data_atual").innerHTML = `Data: ${dia}/${mes}/${ano}`;

    document.getElementById("nome-usuario").innerHTML = sessionStorage.NOME_USUARIO;
    document.getElementById("email-usuario").innerHTML = sessionStorage.EMAIL_USUARIO;

    const ctx = document.getElementById('grafico_alertas');

    // força a legenda ficar oculta
    if (window.Chart && Chart.defaults && Chart.defaults.plugins) {
        Chart.defaults.plugins.legend.display = false;
        if (Chart.defaults.plugins.title) Chart.defaults.plugins.title.display = false;
    }


    grafico_alertas = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
            datasets: [{
                label: '',
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                title: {
                    display: true,
                    text: 'Número de Alertas por Mês',
                    position: 'top',
                    font: {
                        size: 18,
                        color: '#000000',
                        weight: 'bold'
                    }
                }
            }
        }
    });
</script>


</html>